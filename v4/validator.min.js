/**
* Form Validator
* Author : ok8008@yeah.net
* Link : https://github.com/liutian1937/Validator
* Version : v4
*/
(function(){var u={together:!1,errShow:"alert",errBox:"error_strings",errPar:"li",timely:!1},g={extend:function(c,d){var b,a={};for(b in c)a[b]=d[b]?d[b]:c[b];return a},each:function(c,d){var b;if(c.constructor===Array)for(var a=0;a<c.length;a+=1){b=d(a,c[a]);if(b===!1)return!1}else if(typeof c=="object")for(var a in c){b=d(a,c[a]);if(b===!1)return!1}},inArray:function(c,d){var b=0,a=d.length,f={};for(;b<a;b+=1)f[d[b]]=!0;return f[c]},hasClass:function(c,d){var b=new RegExp("(\\s|^)"+d+"(\\s|$)");return c.className.match(b)},insertAfter:function(c,d){var b=d.parentNode;b.lastChild==d?d.appendChild(c):b.insertBefore(c,d.nextSibling)},getPosTop:function(c){return c.offsetParent?c.offsetTop+arguments.callee(c.offsetParent):c.offsetTop},getParent:function(c,d){return c.parentNode.tagName==d?c.parentNode:arguments.callee(c.parentNode,d)},getErrBox:function(c,d,b){var a=c.getElementsByTagName(d),f=0,k=a.length,l;if(k>0)for(;f<k;f+=1)if(g.hasClass(a[f],b))return l=a[f],l;if(l)return l;var h=document.createElement(d);return h.className=b,c.appendChild(h),h},addMsg:function(c,d){c.style.display="inline-block",c.innerHTML=d},bind:function(){if(window.addEventListener)return function(e,t,n,r){e.bindFn=e.bindFn||{},e.bindFn[r]={eventType:t,eventFn:n},e.addEventListener(t,n,!1)};if(window.attachEvent)return function(e,t,n,r){e.bindFn=e.bindFn||{},e.bindFn[r]={eventType:t,eventFn:n},e.attachEvent("on"+t,n)}}(),unbind:function(){if(window.addEventListener)return function(e,t){if(t){if(e.bindFn[t]){var c=e.bindFn[t].eventFn,d=e.bindFn[t].eventType;e.removeEventListener(d,c)}}else{var b;for(b in e.bindFn)e.removeEventListener(e.bindFn[b].eventType,e.bindFn[b].eventFn)}};if(window.attachEvent)return function(e,t){if(t){if(e.bindFn[t]){var c=e.bindFn[t].eventFn,d=e.bindFn[t].eventType;e.detachEvent("on"+d,c)}}else{var b;for(b in e.bindFn)e.detachEvent("on"+e.bindFn[b].eventType,e.bindFn[b].eventFn)}}}(),isEmpty:function(c){return c=c.replace(/(^\s*)|(\s*$)/g,""),c.length==0?!0:!1}},i=function(c,d){if(!(this instanceof i))return new i(c,d);this.options=g.extend(u,d),this.formobj=document.forms[c];if(!this.formobj)return alert("找不到表单"+c),!1;this.init()};i.fn=i.prototype,i.fn.init=function(c){var d=this,b=this.formobj;c?(d.hideError(),d.options=g.extend(u,c)):(b.oldSubmit=null,b.onsubmit&&(b.oldSubmit=b.onsubmit,b.onsubmit=null),b.onsubmit=function(){return d.checkForm()?(d.showError(),!1):b.oldSubmit?b.oldSubmit():!0},d.ruleData=[],d.errObjList={},d.errorHash={},d.errorArray=[],d.errorFnArray=[],d.jump=!0)},i.fn.addRule=function(b){var a=this;return b.constructor===Array&&(b[0].constructor===Array?g.each(b,function(c,d){a.initRule(d)}):a.initRule(b)),a},i.fn.removeRule=function(c){var d=this,b,a,f=[],k,l;if(c.constructor===Array)if(c[0].constructor===Array)for(var h=0;h<c.length;h+=1)b=c[h][0],a=c[h][1],d.removeRuleFn(b,a);else b=c[0],a=c[1],d.removeRuleFn(b,a);else typeof c=="string"&&d.removeRuleFn(c)},i.fn.removeRuleFn=function(c,d){var b=this;if(d){for(var a=0;a<b.ruleData.length;a+=1)if(b.ruleData[a].name==c&&b.ruleData[a].rule==d)return g.unbind(b.ruleData[a].obj,d),b.ruleData.splice(a,1),!1}else{var a=b.ruleData.length;while(a>0)a-=1,b.ruleData[a].name==c&&(g.unbind(b.ruleData[a].obj),b.ruleData.splice(a,1))}},i.fn.destory=function(){var c=this,d=c.formobj.getElementsByTagName("input"),b=c.formobj.getElementsByTagName("select"),a=c.formobj.getElementsByTagName("textarea");for(var f=0;f<d.length;f+=1)g.unbind(d[f]);for(var f=0;f<b.length;f+=1)g.unbind(b[f]);for(var f=0;f<a.length;f+=1)g.unbind(a[f]);c.formobj.oldSubmit=null,c.formobj.onsubmit=null,c.init()},i.fn.initRule=function(a){var f=this,k,l,h,p,m,j={};p=a[0],m=f.formobj[p];if(!m)return!1;k=a[1].search("="),k>=0?(l=a[1].substring(0,k),h=a[1].substr(k+1),l!="regex"&&(h=isNaN(h)?h:parseInt(h),/^('|")\w+/.test(h)&&(h=h.replace(/^('|")|('|")$/g,"").split("|")))):(l=a[1],h=undefined),j={name:p,obj:m,rule:l,ruleExt:h!==!1?h:"",msg:a[2]||""},f.ruleData.push(j),f.options.timely&&function(b){m.length>0?m.tagName=="SELECT"?function(){g.bind(m,"change",function(){f.checkSingle(b,!0),f.checkError(b)},b.rule)}():function(){for(var d=0;d<m.length;d+=1)(function(c){g.bind(m[c],"click",function(){f.checkSingle(b,!0),f.checkError(b)},b.rule)})(d)}():(g.bind(m,"focus",function(){f.hideError(b.name)},b.rule),g.bind(m,"blur",function(){f.checkSingle(b,!0),f.checkError(b)},b.rule))}(j)},i.fn.checkForm=function(){var b=this;return b.errorHash={},b.errorArray=[],b.hideError(),g.each(b.ruleData,function(c,d){if(b.options.together)b.checkSingle(d);else{if(!(b.errorArray.length<1))return!1;b.checkSingle(d)}}),b.errorArray.length>0?!0:!1},i.fn.checkSingle=function(b,a){var f=this;if(!w.call(f,b)){if(!f.errorHash[b.name]){var k=f.errorArray.push(b);f.errorHash[b.name]=k}}else{var l=!1,k=f.errorHash[b.name];a&&k>0&&g.each(f.errorArray,function(c,d){if(d["name"]==b.name&&f.errorArray[c]["rule"]==b.rule)return f.errorArray.splice(c,1),f.errorHash[b.name]=!1,!1})}},i.fn.showError=function(){var a=this,f=[],k;if(typeof a.options.errShow=="function")a.options.errShow(a.errorArray);else switch(a.options.errShow){case"alert":case"multiple":g.each(a.errorArray,function(c,d){typeof d.msg=="string"?f.push(d.msg):typeof d.msg=="function"&&d.msg()}),a.options.errShow=="alert"?f.length>0&&alert(f.join("\n")):a.showErrorBox(a.formobj,f.join("<br/>"));break;case"single":g.each(a.errorArray,function(c,d){if(a.jump){var b=g.getPosTop(d.obj)-10;scrollTo(0,b),a.jump=!1}typeof d.msg=="string"?a.showErrorSingle(d):typeof d.msg=="function"&&d.msg()}),a.jump=!0}},i.fn.showErrorSingle=function(c){var d=this,b=c.obj,a=c.msg,f=c.name;d.errObjList[f]||(b.tagName!="SELECT"&&b.length&&(b=b[b.length-1]),b=g.getParent(b,d.options.errPar.toUpperCase()),d.errObjList[f]=g.getErrBox(b,"span",d.options.errBox)),typeof a=="string"?g.addMsg(d.errObjList[f],a):typeof a=="function"&&a()},i.fn.showErrorBox=function(c,d){var b=this,a=c.parentNode.getElementsByTagName("div");if(b.errGlobalObj)b.errGlobalObj.innerHTML=d,b.errGlobalObj.style.display="block";else{for(var f=0;f<a.length;f+=1)if(g.hasClass(a[f],b.options.errBox))return b.errGlobalObj=a[f],g.addMsg(b.errGlobalObj,d),!1;b.errGlobalObj||(b.errGlobalObj=document.createElement("div"),b.errGlobalObj.className=b.options.errBox,b.errGlobalObj.innerHTML=d,b.errGlobalObj.style.display="block",g.insertAfter(b.errGlobalObj,c))}},i.fn.checkError=function(b){var a=this,f=a.errorHash[b.name];a.errGlobalObj&&(a.errGlobalObj.style.display="none"),f>0?g.each(a.errorArray,function(c,d){if(d["name"]==b.name&&a.errorArray[c]["rule"]==b.rule)return a.showErrorSingle(a.errorArray[c]),!1}):a.hideError(b.name)},i.fn.hideError=function(b){var a=this;if(b)return a.errObjList[b]&&(a.errObjList[b].style.display="none"),!1;a.errGlobalObj&&(a.errGlobalObj.style.display="none"),a.errObjList&&g.each(a.errObjList,function(c,d){d.style.display="none"})};var w=function(a){var f=a.rule;switch(f){case"regex":return eval(a.ruleExt).test(a.obj.value);case"required":return g.isEmpty(a.obj.value)?!1:!0;case"maxlength":return g.isEmpty(a.obj.value)?!0:a.obj.value.length<=a.ruleExt;case"minlength":return g.isEmpty(a.obj.value)?!0:a.obj.value.length>=a.ruleExt;case"number":return g.isEmpty(a.obj.value)?!0:/^[\d]+$/.test(a.obj.value);case"alpha":return g.isEmpty(a.obj.value)?!0:/^[A-Za-z]+$/.test(a.obj.value);case"string":return g.isEmpty(a.obj.value)?!0:/^\w+$/.test(a.obj.value);case"email":return g.isEmpty(a.obj.value)?!0:/\w+((-w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+/.test(a.obj.value);case"telephone":return g.isEmpty(a.obj.value)?!0:/^[+]{0,1}(\d){1,3}[ ]?([-]?((\d)|[ ]){1,12})+$/.test(a.obj.value);case"mobile":return g.isEmpty(a.obj.value)?!0:/^0?1(3|4|5|8)\d{9}$/.test(a.obj.value);case"url":var k=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;return k.test(a.obj.value);case"lessthan":case"greaterthan":var l=typeof a.ruleExt=="number"?a.ruleExt:parseInt(this.formobj[a.ruleExt].value);return f=="lessthan"?parseInt(a.obj.value)<l:parseInt(a.obj.value)>l;case"equal":case"unequal":var h=a.obj.value,p=a.ruleExt,m=this;return typeof p=="number"?function(){return f=="equal"?parseInt(h)==p:parseInt(h)!=p}():function(){return p.constructor===Array?f=="equal"?g.inArray(h,p):!g.inArray(h,p):f=="equal"?h==m.formobj[p].value:h!=m.formobj[p].value}();case"notselect":return a.obj.tagName=="SELECT"?function(){var c=a.obj.selectedIndex;return a.obj.options[c].value!=a.ruleExt}():function(){var c=a.obj,d=!0;if(c.length){if(a.ruleExt&&a.ruleExt.constructor===Array){q=a.ruleExt.length;for(var b=0;b<c.length;b+=1)if(c[b].checked==1&&g.inArray(c[b].value,a.ruleExt))return d=!1,!1}else for(var b=0;b<c.length;b+=1)if(c[b].checked==1){if(a.ruleExt===undefined)return d=!1,!1;if(c[b].value==a.ruleExt)return d=!1,!1}}else c.checked==1&&(d=!1);return d}();case"shouldselect":var j=a.obj,s=!1,q=0,v=0;if(j.length)if(a.ruleExt&&a.ruleExt.constructor===Array){q=a.ruleExt.length;for(var o=0;o<j.length;o+=1)j[o].checked==1&&g.inArray(j[o].value,a.ruleExt)&&(v+=1);s=q===v?!0:!1}else for(var o=0;o<j.length;o+=1)j[o].checked==1&&(a.ruleExt===undefined?s=!0:j[o].value==a.ruleExt&&(s=!0));else j.checked==1&&(s=!0);return s;case"minselect":case"maxselect":var j=a.obj,q=0;if(j.length)for(var o=0;o<j.length;o+=1)j[o].checked==1&&(q+=1);else j.checked==1&&(q+=1);return f=="minselect"?q>=a.ruleExt:q<=a.ruleExt;default:return!1}};window.Validator=i})()